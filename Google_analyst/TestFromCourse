-- world bank internationsal education, public dataset. BigQuery

-- additions both table code column and added alias AS.

SELECT 
    `bigquery-public-data.world_bank_intl_education.international_education`.country_name, 
    `bigquery-public-data.world_bank_intl_education.country_summary`.country_code AS SummaryTableCode, 
    `bigquery-public-data.world_bank_intl_education.international_education`.country_code AS EducationTableCode,
    `bigquery-public-data.world_bank_intl_education.international_education`.value
FROM 
    `bigquery-public-data.world_bank_intl_education.international_education`
INNER JOIN 
    `bigquery-public-data.world_bank_intl_education.country_summary` 
ON `bigquery-public-data.world_bank_intl_education.country_summary`.country_code = `bigquery-public-data.world_bank_intl_education.international_education`.country_code



-- using aliases "AS" in table naming

SELECT 
    `edu`.country_name, 
    `Summary`.country_code AS SummaryTableCode, 
    `edu`.country_code AS EducationTableCode,
    `edu`.value
FROM 
    `bigquery-public-data.world_bank_intl_education.international_education` AS edu
INNER JOIN 
    `bigquery-public-data.world_bank_intl_education.country_summary` AS Summary
ON `summary`.country_code = `edu`.country_code


-- actual query in from JOIN

SELECT 
    AVG(edu.value) average_value, summary.region
FROM 
    `bigquery-public-data.world_bank_intl_education.international_education` AS edu
INNER JOIN 
    `bigquery-public-data.world_bank_intl_education.country_summary` AS summary
ON edu.country_code = summary.country_code
WHERE summary.region IS NOT null
GROUP BY summary.region
ORDER BY average_value DESC
